import extract_msg
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph
from reportlab.lib.styles import getSampleStyleSheet

def msg_to_pdf(msg_path, pdf_path):
    # Extract data from MSG
    msg = extract_msg.Message(msg_path)
    sender = msg.sender or "Unknown Sender"
    date = msg.date or "Unknown Date"
    subject = msg.subject or "No Subject"
    body = msg.body or ""

    # Create PDF
    doc = SimpleDocTemplate(pdf_path, pagesize=letter)
    styles = getSampleStyleSheet()
    story = [
        Paragraph(f"<b>From:</b> {sender}", styles['Normal']),
        Paragraph(f"<b>Date:</b> {date}", styles['Normal']),
        Paragraph(f"<b>Subject:</b> {subject}", styles['Normal']),
        Paragraph("<br/>", styles['Normal']),
        Paragraph(body.replace("\n", "<br/>"), styles['Normal'])
    ]
    doc.build(story)
    print(f"PDF saved: {pdf_path}")

# Example usage
msg_to_pdf("sample_email.msg", "sample_email.pdf")
