output_result = result.get("output_result", []) or []
    for i, item in enumerate(output_result):
        if not isinstance(item, dict):
            continue
        res_dict = item.get("res")
        if isinstance(res_dict, dict) and res_dict:
            # dict-of-dicts to DataFrame (index -> rows)
            df = pd.DataFrame.from_dict(res_dict, orient="index")
            # Optional: keep the bbox/type as metadata (one row) â€“ uncomment to include
            # df.attrs["bbox"] = item.get("bbox")
            # df.attrs["type"] = item.get("type")

            stem = os.path.splitext(result.get("file_name", "output"))[0]
            csv_path = os.path.join(out_dir, f"{stem}_table{i}.csv")
            df.to_csv(csv_path, index=False)
